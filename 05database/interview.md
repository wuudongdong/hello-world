# 面试题
## 1. 事务的隔离级别分别解决什么问题？怎么实现的？
事务的隔离级别分为四层：读未提交、读已提交、可重复读、可串行化。读未提交未解决任何事务并发问题，读已提交解决脏读（一个事务读取到另一个
事务未提交的数据）的问题，可重复读解决不可重复读（一个事务读取到另一个事务已提交的数据）的问题，可串行化解决幻读（一个事务中多次条件查询的结果不一致）
的问题。oracle的默认的事务隔离级别是读已提交，mysql默认的事务隔离级别是可重复读。
读已提交和可重复读在mysql中是靠MVCC多版本并发控制来实现的，每条数据都有一个隐藏列是事务id代表这条数据的版本，而事务id是一个单调递增的序列，这样
每个事务都只能拿到比自己版本号小的数据。

## 2. 事务四大特性是什么？
ACID，A是原子性，一组操作要么全部成功，要么全部失败。C是一致性，数据库跨表、跨行、始终保持在一致性的状态。I是隔离性，事务之间互不影响。D是持久性，
事务完成后，数据持久化保存。

## 3. MySQL有哪些存储引擎，它们的区别和适用场景是什么？
MySQL默认使用的是InnoDB，支持事务、外键、行级锁，除它之外的所有存储引擎都不支持事务。Myisam不支持事务和外键，只有表锁。它适用于只有插入和查询的
表，处理速度比InnoDB快，它的的索引是非聚集索引，索引文件和数据文件分开存放，寻找直接比InnoDB快，不用维护MVCC，占用的空间也小。Memory的数据存储
在内存中，数据不可持久化，适用于做临时表，Archive归档引擎，支持数据压缩，适用于指查询和插入的数据，如日志信息。

## 4. MySQL索引有哪些类型？索引的数据结构有哪些？这些数据结构的适用场景？
MySQL索引分为两种主键索引和非主键索引，主键索引又可以称作聚簇索引，非主键索引又可称作二级索引。聚簇索引的意思是叶子节点的主键和数据行是存放在一起的，
二级索引的叶子节点则只有主键。索引的数据模型有三种，分别是哈希表、有序数组、搜索树。哈希表时候由于定值搜索。有序数组适用于静态数据搜索。搜索树时间复
杂度是O（log（N）），适合磁盘访问特性，磁盘随机读取一个数据块的时间大概在10ms左右，N叉树可以减少磁盘IO次数，故MySQL适用B+树作为索引的数据结构。
为了减少页分裂和页合并，尽量适用自增主键。

## 5. B树和B+树的区别是什么？
B树和B+树的区别主要有两点：一是B+树的中间节点不存放数据，二是B+树的叶子节点间有链指针。根据磁盘预读和局部性原理，中间节点不存放数据，那么一次能读
取到节点数量更多，节点之间有指针，区间访问性更好，对于索引范围查找，性能更高。

参考资料：https://www.jianshu.com/p/0371c9569736

## 6. 联合索引的生效条件是什么？
联合索引的索引项中包含多个字段，分别从左到右排列。索引的最左前缀原则指的是索引生效的条件是查询条件中用到最左边的N个字段或者第一个字段的M个字符。索引
下推优化指的是在通过联合索引的其他字段判断减少回表次数。

参考资料：https://time.geekbang.org/column/article/69636

## 7. MySQL的锁有哪些类型？分别用来做什么？
MySQL的锁有分为全局锁、表级锁、行锁。
- 全局锁
  使用Flush tables with read lock命令来使用，用来锁整个数据库，数据备份时使用。如果数据库中所有的表都使用的是InnoDB存储引擎，那么可以使
用一致性视图来对数据库加锁。
- 表级锁  
  1. MDL
    MDL也分为读锁和写锁，读锁在我们对表做增删改查时，数库会默认给我们加上，写锁是当我们改表结构时，MySQL会默认加写锁。读写锁是冲突的，当我们持有
  MDL读锁，也就是我们在查表的一条数据时，是不能改表结构的，只有读锁释放，加上写锁才能改表结构。
  2. 表锁
    表锁的语法是lock tables x read/write。lock tables t1 read, t2 write;表示只能对t1读，对t2读写，别的表也不能访问。
- 行锁
  行锁没有特定的语法，当事务并发更新同一条数据时，数据库会帮我们加锁。两阶段锁协议是指行锁需要时才加上，等事务提交以后才释放。

参考资料：https://learnku.com/articles/39212